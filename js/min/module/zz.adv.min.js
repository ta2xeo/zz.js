"use strict";zz.adv=new function(){var a="#ffffff";var b="#000000";var c=0.75;var d=50;var e=15;var f=20;var g=10;var h="170%";var i="5px ridge #0f00f0";function j(a){var b=[];for(var c=0,d=a.length;c<d;c++)b.push(a.substr(0,c+1));return b;}function k(a){var b=[];var c={};var d={marks:{},rt:false,rp:false,inside:function(){return this.rt||this.rp;}};function e(a){var d=b.length;if(d in c===false)c[d]=[];c[d].push(a);}function f(a,b,c){var f={tag:a,attrs:b,unary:c,start:true,createTag:function(){var d=["<",a];for(var e=0,f=b.length;e<f;e++)d.push(" "+b[e].name+"="+b[e].value);d.push(c?"/>":">");return d.join("");}};e(f);if(a=="rt")d.rt=true;if(a=="rp")d.rp=true;}function g(a){var b={tag:a,end:true,createTag:function(){return "</"+a+">";}};e(b);if(a=="rt")d.rt=false;if(a=="rp")d.rp=false;}HTMLParser(a,{start:function(a,b,c){f(a,b,c);},end:function(a){g(a);},chars:function(a){for(var c=0,e=a.length;c<e;c++){if(d.inside())d.marks[b.length]=true;b.push(a[c]);}},comment:function(a){}});var h=[];for(var i=0,j=b.length;i<j;i++){var k=b.slice(0,i+1);var l=[];var m={};for(var n in c){var o=c[n].map(function(a){if(n<=i){if(!a.unary)if(a.start){if(a.tag in m===false)m[a.tag]=0;++m[a.tag];}else if(a.end)--m[a.tag];return a.createTag();}else if(!a.unary)if(a.end&&m[a.tag]>0){--m[a.tag];return a.createTag();}return "";});l.unshift({index:n,tag:o.join("")});}for(var p=0,q=l.length;p<q;p++){var r=l[p].index;if(r>i+1)r=i+1;k.splice(r,0,l[p].tag);}if(i+1 in d.marks===false)h.push(k.join(""));}return h;}function l(a,b){zz.Event.call(this,a);this.characters=b||0;}var m={STAND_BY:"__typewriter_event_stand_by__",START:"__typewriter_event_start__",READING:"__typewriter_event_reading__",END:"__typewriter_event_end__"};for(var n in m)l[n]=m[n];l.prototype=zz.createClass(zz.Event,{});var o=new function(){function a(a){zz.TextField.call(this);this.textWait=d;this.setText(a||[]);this.parser=j;}a.prototype=zz.createClass(zz.TextField,{setText:function(a){if(typeof a=="string")this._textArray=[a];else if(a instanceof Array)this._textArray=a;else throw new zz.ZZError("textArray is invalid arg.");this.ready=true;},_print:function(){var a=this._index>=this.current.length?this.current.length-1:this._index;this.text=this.current[a];this.dispatchEvent(new l(l.TYPING,a+1));},_start:function(){this.ready=false;this._count=0;this._index=0;this._print();this.addEventListener(zz.Event.ENTER_FRAME,this._sequence);},_end:function(){this.ready=true;if(this._textArray.length===0)this.dispatchEvent(new l(l.END));else this.dispatchEvent(new l(l.STAND_BY));this.removeEventListener(Event.ENTER_FRAME,this._sequence);},_sequence:function(){var a=this.textWait*this.root.frameRate/1000;var b=a===0?this.current.length:1/a<<0;if(b<1)b=1;++this._count;if(this._count>a){this._index+=b;this._print();this._count=0;if(!this.current[this._index])this._end();}},next:function(){var a=this._textArray.shift();this.current=this.parser(a);},flash:function(){this.text=this.current[this.current.length-1];this._end();},typing:function(){if(this._textArray.length!==0){this.next();this.dispatchEvent(new l(l.START));this._start();}else this.dispatchEvent(new l(l.END));},read:function(){if(this.ready)this.typing();else this.flash();}});return a;}();function p(){zz.MovieClip.apply(this);var b=new zz.TextField();b.text="â–¼";b.textColor=a;this.addChild(b);this.width=30;this.height=30;this.setAnimation({1:{alpha:0,tween:true},15:{alpha:1,tween:true},30:{alpha:0,tween:true}});}p.prototype=zz.createClass(zz.MovieClip,{});function q(i,j,k){zz.DisplayObjectContainer.apply(this);this.backgroundColor=b;this.alpha=c;this.setSize(i,j);this.style.borderRadius=(k||e)+"px";this.textWait=d;this.text=new o();this.text.autoResize=false;this.text.setSize(i-l,j);this.text.textColor=a;this.text.style.lineHeight=h;var l=f;var m=g;this.text.style.padding=[m+"px",l+"px",0+"px"].join(" ");this.setText([]);this.readyIcon=new p();this.readyIcon.referencePoint=zz.ReferencePoint.BOTTOM|zz.ReferencePoint.RIGHT;this.readyIcon.setPosition(this.width-10,this.height-10);this.addChild(this.text);this.addChild(this.readyIcon);}q.prototype=zz.createClass(zz.DisplayObjectContainer,{setText:function(a){this.text.setText(a);},setParser:function(a){this.text.parser=a;},erase:function(){this.text.text="";},read:function(){this.text.read();},ready:{get:function(){return this._ready;},set:function(a){this._ready=a;if(this.readyIcon){this.readyIcon.visible=this._ready;if(this._ready)this.readyIcon.gotoAndPlay(1);else this.readyIcon.stop();}}}});function r(c,d,f){zz.Sprite.apply(this);this.setSize(c,d);this.backgroundColor=b;this.style.borderRadius=(f||e)+"px";this.style.border=i;this._nameText=new zz.TextField();this._nameText.referencePoint=zz.ReferencePoint.CENTER;this._nameText.setPosition(this.width/2,this.height/2);this._nameText.textColor=a;this.defaultNameColor=this.nameColor;this.addChild(this._nameText);this.nameColors={};}r.prototype=zz.createClass(zz.Sprite,{who:{get:function(){return this._nameText.text;},set:function(a){this._nameText.text=a;if(a in this.nameColors)this.nameColor=this.nameColors[a];else this.nameColor=this.defaultNameColor;}},nameColor:{get:function(){return this._nameText.textColor;},set:function(a){this._nameText.textColor=a;}}});function s(a){var b=a.mc||new zz.Sprite(a.path);b.referencePoint=zz.ReferencePoint.CENTER;b.x=a.x||0;b.y=a.y||0;if(a.active!==undefined&&!a.active)b.brightness=-20;return b;}function t(a,b){zz.DisplayObjectContainer.call(this);this.imageContainer=new zz.DisplayObjectContainer();this.imageContainer.referencePoint=zz.ReferencePoint.BOTTOM|zz.ReferencePoint.CENTER;this.textArea=a;this.namePlate=b;this.addChild(this.imageContainer);this.addChild(a);this.addChild(b);var c=this;this.textArea.text.addEventListener(l.END,function(){if(typeof c.end=="function")c.end();});this.textArea.text.addEventListener(l.START,function(){var a=c.names.shift();if(a)c.namePlate.who=a;var b=c.images.shift();for(var d=0,e=c.imageContainer.numChildren;d<e;d++){var f=c.imageContainer.getChildAt(d);f.removeSelf();}if(b){if(b instanceof Array===false)b=[b];for(d=0,e=b.length;d<e;d++){var g=b[d];c.imageContainer.addChild(new s(g));}}});}t.prototype=zz.createClass(zz.DisplayObjectContainer,{setData:function(a,b){this.names=[];this.images=[];var c=[];for(var d=0,e=a.length;d<e;d++){this.names.push(a[d].name);c.push(a[d].text);this.images.push(a[d].image);}this.textArea.setText(c);this.end=b;},preloadImages:function(a){var b=this.images.filter(function(a){if(a&&a.path)return true;}).map(function(a){return a.path;});zz.preload(b,a);},read:function(){this.textArea.read();},erase:function(){this.namePlate.who="";this.textArea.erase();},setUIPosition:function(a,b,c){this.namePlate.setPosition(a[0],a[1]);this.textArea.setPosition(b[0],b[1]);this.imageContainer.setPosition(c[0],c[1]);}});return zz.modularize({plainTextParser:j,htmlParser:k},{TypewriterEvent:l,Typewriter:o,TextArea:q,NamePlate:r,ADVController:t});}();